Hybrid Embedding Fusion Framework for Face Verification
=======================================================

Overview
--------
This repository contains the complete implementation and experimental logs for the paper:
“A Lightweight Hybrid Embedding Fusion Framework for Face Verification”.

The study evaluates more than 11,000 model combinations across five public datasets using:
- Pre-extracted deep embeddings
- Lightweight machine-learning classifiers
- Systematic two-feature and three-feature fusion strategies

All code and results are shared to ensure transparency and full reproducibility.


Repository Structure
--------------------
code/
    benchmark3_batchEmbeddingALL.py
    magface_multi_eval.py
    run_in_batches_all.py
    fusion_2Model.py
    fusion_2model_Augmentasi.py
    fusion_3Model.py
    fusion_3model_Augmentasi.py
    evaluate_utils.py
    convert.py
    net.py
    baseline_single_distance_adaface_all.py
    baseline_single_distance_cv.py
    baseline_single_distance_magface_all.py
    baseline_single_distance_magface.py

outputs/
    A. baseline performance results.xlsx
    B. single-feature-ML result.xlsx
    C.1. two feature-single ML results.xlsx
    C.2. two feature-multi ML results.xlsx
    D.1. three feature-single ML results.xlsx
    D.2. three feature-multi ML results.xlsx
    single_baseline_cv_10fold.xlsx
    single_baseline_cv.xlsx
    fusion_4_5_6/


Description of Experimental Results
-----------------------------------

1. Baseline Backbone Performance (Table 4)
   Files:
     - A. baseline performance results.xlsx
     - single_baseline_cv.xlsx
     - single_baseline_cv_10fold.xlsx

   Related scripts:
     - magface_multi_eval.py
     - baseline_single_distance_adaface_all.py
     - baseline_single_distance_magface_all.py
     - baseline_single_distance_magface.py
     - baseline_single_distance_cv.py


2. Single-Feature ML Evaluation (Tables 5–6, Figures 3–4)
   File:
     - B. single-feature-ML result.xlsx

   Generated by:
     python3 run_in_batches_all.py --mode single_feature --embeddings outputs/embeddings/ --out outputs/single_feature/


3. Two-Feature Fusion Results
   Files:
     - C.1. two feature-single ML results.xlsx
     - C.2. two feature-multi ML results.xlsx

   Scripts:
     python3 fusion_2Model.py --embeddings outputs/embeddings/ --out outputs/fusion_2_single/
     python3 fusion_2model_Augmentasi.py --embeddings outputs/embeddings/ --out outputs/fusion_2_multi/


4. Three-Feature Fusion Results
   Files:
     - D.1. three feature-single ML results.xlsx
     - D.2. three feature-multi ML results.xlsx

   Scripts:
     python3 fusion_3Model.py --embeddings outputs/embeddings/ --out outputs/fusion_3_single/
     python3 fusion_3model_Augmentasi.py --embeddings outputs/embeddings/ --out outputs/fusion_3_multi/


5. Extended Feature Comparisons
   Folder:
     - fusion_4_5_6/
   Contains additional fusion comparisons beyond two-feature and three-feature settings.


Hardware Specification
----------------------
All experiments were executed on:

- CPU: Intel Core i9-13900K
- GPU: NVIDIA RTX 4080 SUPER
- RAM: 64 GB
- OS: Ubuntu 24.10
- Python 3.x (NumPy, scikit-learn, XGBoost, Optuna)

Embeddings were precomputed once, so all fusion experiments operate on lightweight 512-dimensional vectors without running CNN inference.


How to Reproduce the Experiments
--------------------------------

Step 1 — Generate embeddings
    python3 benchmark3_batchEmbeddingALL.py --output outputs/embeddings/

Step 2 — Baseline evaluation
    python3 magface_multi_eval.py --embeddings outputs/embeddings/ --out outputs/baseline/

Optional baseline scripts:
    python3 baseline_single_distance_adaface_all.py
    python3 baseline_single_distance_magface_all.py
    python3 baseline_single_distance_magface.py
    python3 baseline_single_distance_cv.py

Step 3 — Single-feature evaluation (AdaFace)
    python3 run_in_batches_all.py --mode single_feature --embeddings outputs/embeddings/ --out outputs/single_feature/

Step 4 — Two-feature fusion
    python3 fusion_2Model.py --embeddings outputs/embeddings/ --out outputs/fusion_2_single/
    python3 fusion_2model_Augmentasi.py --embeddings outputs/embeddings/ --out outputs/fusion_2_multi/

Step 5 — Three-feature fusion
    python3 fusion_3Model.py --embeddings outputs/embeddings/ --out outputs/fusion_3_single/
    python3 fusion_3model_Augmentasi.py --embeddings outputs/embeddings/ --out outputs/fusion_3_multi/

Utility tools:
    python3 convert.py
    python3 evaluate_utils.py


Citation
--------
Please cite the corresponding paper if you use this repository.


Contact
-------
For questions or collaboration requests, please contact the corresponding author.
kurniawan: muchamad.kurniawan@itats.ac.id
